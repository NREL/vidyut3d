AMREX_HOME ?= ../../../..
VIDYUT_DIR   ?= ../../../vidyut3d

TOP := $(VIDYUT_DIR)

EBASE := vidyut
BL_NO_FORT = TRUE

include $(AMREX_HOME)/Tools/GNUMake/Make.defs

Bdirs 	:= Source
Bpack	+= $(foreach dir, $(Bdirs), $(TOP)/$(dir)/Make.package)
Blocs   += $(foreach dir, $(Bdirs), $(TOP)/$(dir))

include $(Bpack)

INCLUDE_LOCATIONS += $(Blocs)
VPATH_LOCATIONS   += $(Blocs)

Pdirs 	:= Base Boundary AmrCore LinearSolvers/MLMG
ifeq ($(USE_SENSEI_INSITU),TRUE)
	Pdirs += Amr Extern/SENSEI
endif
ifeq ($(USE_CVODE),TRUE)
#  include $(TOP)/Source/Reactor/Make.package
	INCLUDE_LOCATIONS   += $(TOP)/Submodules/sundials/include
  CPPFLAGS += -DUSE_CVODE
  Pdirs += Extern/SUNDIALS
  REL_SUNDIALS_LIB_DIR := $(VIDYUT_DIR)/Submodules/sundials/lib
  SUNDIALS_LIB_DIR := $(abspath $(lastword $(REL_SUNDIALS_LIB_DIR)))
  LIBRARIES += -L$(SUNDIALS_LIB_DIR) -lsundials_cvode -lsundials_arkode
  LIBRARIES += -L$(SUNDIALS_LIB_DIR) -lsundials_core -lsundials_nvecserial
endif
Ppack	+= $(foreach dir, $(Pdirs), $(AMREX_HOME)/Src/$(dir)/Make.package)

include $(Ppack)

all: $(executable) 
	@echo SUCCESS

include $(AMREX_HOME)/Tools/GNUMake/Make.rules
